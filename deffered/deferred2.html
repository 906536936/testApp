<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Deferred</title>

    </head>
    <body>
        <pre><code>
            if (flag % 2) {
                // def 调用resolve改变状态之后，会触发通过def done指定的方法
                def.resolve("success");
            } else {
                // def 调用rejct 改变状态诸侯，会触发通过def fail指定的方法
                def.reject("fail");
            }
            </code>
        </pre>
    </body>
    <script src="../jquery1.10.2.min.js"></script>
    <script>
        var def = $.Deferred(),
            flag = 2|(Math.random()*1000);

        var wait = function () {

            var task = function () {
                if (flag % 2) {
                    // def 调用resolve改变状态之后，会触发通过def done指定的方法
                    def.resolve("success");
                } else {
                    // def 调用rejct 改变状态诸侯，会触发通过def fail指定的方法
                    def.reject("fail");
                }
            };

            setTimeout(task, 1000);

            return def;
        };

        // when方法比接受一个def对象
        $.when(wait()).done(function (m) {
            console.log(m);
        }).fail(function (m) {
            console.log(m);
        });
    </script>
</html>